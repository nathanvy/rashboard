<div class="dashboard">
  <h1>Zalgo Performance</h1>

<div class="equity-curve">
  <%= image_tag '/equitycurve.png', alt: 'Intraday Equity Curve', class: 'equity-chart' %>
</div>

<h2>Transactions</h2>
<div class="table-container">
  <table class="table">
    <thead>
      <tr>
        <% if @trades.any? %>
          <% @trades.first.attributes.keys.each do |col| %>
            <th><%= col.titleize %></th>
          <% end %>
        <% else %>
          <th>No transactions available</th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @trades.each do |trade| %>
        <tr>
          <% trade.attributes.values.each do |val| %>
            <td><%= val %></td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<h2>Completed Trades</h2>
<div class="table-container">
  <table class="table">
    <thead>
      <tr>
        <% @completed_columns.each do |col| %>
        <th><%= @completed_column_labels[col].html_safe %></th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @completed.each do |c| %>
        <tr>
          <% @completed_columns.each do |col| %>
          <td>
            <% value = c[col] %>
            <% case col
               when :expiry then concat l(value, format: :short)
               when :open_price, :close_price, :dPnL, :deltaPL, :thetaPL, :vegaPL, :gammaPL, :residual
               then concat number_with_precision(value, precision: 2)
               else
               concat value
               end %>
          </td>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
</div>
